{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/klose/workspace/myfishing/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _createForOfIteratorHelper from\"C:/Users/klose/workspace/myfishing/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"C:/Users/klose/workspace/myfishing/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"C:/Users/klose/workspace/myfishing/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"C:/Users/klose/workspace/myfishing/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/klose/workspace/myfishing/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject,_templateObject2,_templateObject3;import{useEffect,useState}from'react';import{MFInput}from'component/column/input/mf_input';import{MFPicklist}from'component/column/input/mf_picklist';import{MFMultiPicklist}from'component/column/input/mf_multipicklist';import{MFTextarea}from'component/column/input/mf_textarea';import{MFButton}from'component/button/mf_button';import{isDateForInput}from'component/column/columnDef';import{textColumns,numberColumns,picklistColumns,multiPicklistColumns,textareaColumns,dateColumns}from'component/column/columns';import styled from\"styled-components\";import{StyledWrapper,StyledOuter}from'commonCSS/style';// import { testData } from 'testData'\nimport{order}from'page/diary/dialyColumnOrder';import{ModalSppiner}from'component/spinner/modalSpinner';import{useNavigate}from'react-router-dom';import{formatDate,DateFormat}from'utils/format/formatDate';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var DiaryEntry=function DiaryEntry(){// 各項目のuseStateを宣言\nvar _useState=useState(formatDate(new Date(),DateFormat.YYYY_MM_DD)),_useState2=_slicedToArray(_useState,2),date=_useState2[0],setDate=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),place=_useState4[0],setPlace=_useState4[1];var _useState5=useState(['']),_useState6=_slicedToArray(_useState5,2),caughtFish=_useState6[0],setCaughtFish=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),comment=_useState8[0],setComment=_useState8[1];var _useState9=useState(['']),_useState10=_slicedToArray(_useState9,2),rod=_useState10[0],setRod=_useState10[1];var _useState11=useState(['']),_useState12=_slicedToArray(_useState11,2),method=_useState12[0],setMethod=_useState12[1];var _useState13=useState(['']),_useState14=_slicedToArray(_useState13,2),lure=_useState14[0],setLure=_useState14[1];var _useState15=useState(''),_useState16=_slicedToArray(_useState15,2),weather=_useState16[0],setWeather=_useState16[1];var _useState17=useState(0),_useState18=_slicedToArray(_useState17,2),wind=_useState18[0],setWind=_useState18[1];var _useState19=useState(''),_useState20=_slicedToArray(_useState19,2),tide=_useState20[0],setTide=_useState20[1];var _useState21=useState(),_useState22=_slicedToArray(_useState21,2),orderedColumns=_useState22[0],setOrderedColumns=_useState22[1];var _useState23=useState(false),_useState24=_slicedToArray(_useState23,2),isLoad=_useState24[0],setIsLoad=_useState24[1];var navigate=useNavigate();// URLパラメータからid値を取得する\n// 取得値がidの正規表現に合致しない場合は新規レコード作成画面とみなす\n// ページ初期化\nuseEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var columns;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:console.log('useEffect start');// 項目定義情報の取得\ncolumns=[].concat(_toConsumableArray(textColumns),_toConsumableArray(numberColumns),_toConsumableArray(dateColumns),_toConsumableArray(picklistColumns),_toConsumableArray(multiPicklistColumns),_toConsumableArray(textareaColumns));// ここから編集時のみの処理\n// サーバーから初期値を取得 await\n// サーバーからの値をrecordに注入\n// for(let c of columns){\n//     if(testData[c.id]) c.value = testData[c.id];\n// }\n// 初期値を各stateにセット\n// setPlace(testData.place ?? '');\n// setCaughtFish(testData.caughtFish ?? []);\n// setComment(testData.comment ?? '');\n// setRod(testData.rod ?? []);\n// setMethod(testData.method ?? []);\n// setLure(testData.lure ?? []);\n// setWeather(testData.weather ?? '');\n// setWind(testData.wind ?? 0);\n// setTide(testData.tide ?? '');\n//ここまで編集時のみの処理\n// columnOrderの順に項目の並び替え\ninjectHandleChange(columns);setOrderedColumns(sortColumns(order,columns));console.log(orderedColumns);case 5:case\"end\":return _context.stop();}}},_callee);}))();},[]);var sortColumns=function sortColumns(order,columns){var result=[];var _iterator=_createForOfIteratorHelper(order),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var o=_step.value;var _iterator2=_createForOfIteratorHelper(columns),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var c=_step2.value;if(c.id===o){result.push(c);break;}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}}catch(err){_iterator.e(err);}finally{_iterator.f();}return result;};var injectHandleChange=function injectHandleChange(columns){var _iterator3=_createForOfIteratorHelper(columns),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var c=_step3.value;if(c.id==='date')c.handleChange=setDate;if(c.id==='place')c.handleChange=setPlace;if(c.id==='caughtFish')c.handleChange=setCaughtFish;if(c.id==='comment')c.handleChange=setComment;if(c.id==='rod')c.handleChange=setRod;if(c.id==='method')c.handleChange=setMethod;if(c.id==='lure')c.handleChange=setLure;if(c.id==='weather')c.handleChange=setWeather;if(c.id==='wind')c.handleChange=setWind;if(c.id==='tide')c.handleChange=setTide;}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}};var submit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log('★submit★');setIsLoad(true);e.preventDefault();data={date:isDateForInput(date)?date:undefined,place:place,caughtFish:caughtFish,comment:comment,rod:rod,method:method,lure:lure,weather:weather,wind:wind,tide:tide};console.log('data');console.log(data);navigate('/view',{state:{id:1}});case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function submit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(StyledOuter,{children:[isLoad&&/*#__PURE__*/_jsx(ModalSppiner,{height:100,width:100}),/*#__PURE__*/_jsx(StyledWrapper,{children:/*#__PURE__*/_jsxs(\"form\",{method:\"post\",onSubmit:submit,children:[/*#__PURE__*/_jsx(StyledContainer,{children:orderedColumns===null||orderedColumns===void 0?void 0:orderedColumns.map(function(oc){if(isInput(oc)){console.log(oc.value);return/*#__PURE__*/_jsx(MFInput,{label:oc.label,id:oc.id,input:oc.input,value:oc.value,handleChange:oc.handleChange},oc.id);}else if(isPickList(oc)){console.log(oc.value);return/*#__PURE__*/_jsx(MFPicklist,{label:oc.label,id:oc.id,select:oc.select,options:oc.options,value:oc.value,handleChange:oc.handleChange},oc.id);}else if(isMultiPickList(oc)){console.log(oc.value);return/*#__PURE__*/_jsx(MFMultiPicklist,{label:oc.label,id:oc.id,select:oc.select,options:oc.options,value:oc.value,handleChange:oc.handleChange},oc.id);}else if(isTextarea(oc)){return/*#__PURE__*/_jsx(MFTextarea,{label:oc.label,id:oc.id,textarea:oc.textarea,value:oc.value,handleChange:oc.handleChange},oc.id);}})}),/*#__PURE__*/_jsxs(StyledButtonWrapper,{children:[/*#__PURE__*/_jsx(StyledButtonContainer,{children:/*#__PURE__*/_jsx(MFButton,{type:'submit',disabled:false,mode:'positive',hidden:false,children:\"\\u4FDD\\u5B58\"})}),/*#__PURE__*/_jsx(StyledButtonContainer,{children:/*#__PURE__*/_jsx(MFButton,{type:'button',disabled:false,mode:'negative',hidden:false,children:\"\\u623B\\u308B\"})})]})]})})]});};var isInput=function isInput(column){return column.type==='input';};var isPickList=function isPickList(column){return column.type==='picklist';};var isMultiPickList=function isMultiPickList(column){return column.type==='multipicklist';};var isTextarea=function isTextarea(column){return column.type==='textarea';};var StyledContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\ndisplay: grid;\\npadding-top: 100px;\\ngrid-auto-rows: 150px;\\ngrid-template-columns: 50% 50%;\\n\"])));var StyledButtonWrapper=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\nwidth: 30%;\\nmargin: 0 auto;\\nheight: 150px;\\nalign-items: center;\\njustify-content: center;\\ndisplay: flex;\\nz-index: 0;\\n\"])));var StyledButtonContainer=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\nmargin: 0 10%;\\n\"])));export default DiaryEntry;","map":{"version":3,"sources":["C:/Users/klose/workspace/myfishing/frontend/src/page/diary/diaryEntry.tsx"],"names":["useEffect","useState","MFInput","MFPicklist","MFMultiPicklist","MFTextarea","MFButton","isDateForInput","textColumns","numberColumns","picklistColumns","multiPicklistColumns","textareaColumns","dateColumns","styled","StyledWrapper","StyledOuter","order","ModalSppiner","useNavigate","formatDate","DateFormat","DiaryEntry","Date","YYYY_MM_DD","date","setDate","place","setPlace","caughtFish","setCaughtFish","comment","setComment","rod","setRod","method","setMethod","lure","setLure","weather","setWeather","wind","setWind","tide","setTide","orderedColumns","setOrderedColumns","isLoad","setIsLoad","navigate","console","log","columns","injectHandleChange","sortColumns","result","o","c","id","push","handleChange","submit","e","preventDefault","data","undefined","state","map","oc","isInput","value","label","input","isPickList","select","options","isMultiPickList","isTextarea","textarea","column","type","StyledContainer","div","StyledButtonWrapper","StyledButtonContainer"],"mappings":"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","sourcesContent":["import { useEffect, useState, VFC, SyntheticEvent } from 'react';\r\nimport { MFInput } from 'component/column/input/mf_input';\r\nimport { MFPicklist } from 'component/column/input/mf_picklist';\r\nimport { MFMultiPicklist } from 'component/column/input/mf_multipicklist';\r\nimport { MFTextarea } from 'component/column/input/mf_textarea';\r\nimport { MFButton } from 'component/button/mf_button';\r\nimport {\r\n    Column, \r\n    TextColumn, \r\n    NumberColumn, \r\n    PicklistColumn, \r\n    MultiPicklistColumn, \r\n    TextareaColumn, \r\n    isDateForInput,\r\n    DateForInput,\r\n} from 'component/column/columnDef';\r\nimport {\r\n    textColumns, \r\n    numberColumns,\r\n    picklistColumns,\r\n    multiPicklistColumns,\r\n    textareaColumns,\r\n    dateColumns\r\n} from 'component/column/columns';\r\nimport styled from \"styled-components\";\r\nimport { StyledWrapper, StyledOuter } from 'commonCSS/style'\r\n// import { testData } from 'testData'\r\nimport { order } from 'page/diary/dialyColumnOrder'\r\nimport { ModalSppiner } from 'component/spinner/modalSpinner'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport { formatDate, DateFormat } from 'utils/format/formatDate'\r\nimport { Diary } from 'dataType/diary'\r\n\r\n\r\nconst DiaryEntry: VFC = () => {\r\n    // 各項目のuseStateを宣言\r\n    const [date, setDate] = useState(formatDate(new Date(), DateFormat.YYYY_MM_DD));\r\n    const [place, setPlace] = useState('');\r\n    const [caughtFish, setCaughtFish] = useState(['']);\r\n    const [comment, setComment] = useState('');\r\n    const [rod, setRod] = useState(['']);\r\n    const [method, setMethod] = useState(['']);\r\n    const [lure, setLure] = useState(['']);\r\n    const [weather, setWeather] = useState('');\r\n    const [wind, setWind] = useState(0);\r\n    const [tide, setTide] = useState('');\r\n\r\n    const [orderedColumns, setOrderedColumns] = useState<Column[]>();\r\n    const [isLoad, setIsLoad] = useState<boolean>(false);\r\n\r\n    const navigate = useNavigate();\r\n\r\n    // URLパラメータからid値を取得する\r\n    // 取得値がidの正規表現に合致しない場合は新規レコード作成画面とみなす\r\n\r\n    // ページ初期化\r\n    useEffect(()=> {       \r\n        (\r\n            async () => {\r\n                console.log('useEffect start');\r\n                // 項目定義情報の取得\r\n                const columns: Column[] = [...textColumns, ...numberColumns, ...dateColumns, ...picklistColumns, ...multiPicklistColumns, ...textareaColumns];\r\n            \r\n                // ここから編集時のみの処理\r\n                    // サーバーから初期値を取得 await\r\n\r\n                    // サーバーからの値をrecordに注入\r\n                    // for(let c of columns){\r\n                    //     if(testData[c.id]) c.value = testData[c.id];\r\n                    // }\r\n\r\n                    // 初期値を各stateにセット\r\n                    // setPlace(testData.place ?? '');\r\n                    // setCaughtFish(testData.caughtFish ?? []);\r\n                    // setComment(testData.comment ?? '');\r\n                    // setRod(testData.rod ?? []);\r\n                    // setMethod(testData.method ?? []);\r\n                    // setLure(testData.lure ?? []);\r\n                    // setWeather(testData.weather ?? '');\r\n                    // setWind(testData.wind ?? 0);\r\n                    // setTide(testData.tide ?? '');\r\n                //ここまで編集時のみの処理\r\n                \r\n                // columnOrderの順に項目の並び替え\r\n                injectHandleChange(columns);\r\n                setOrderedColumns(sortColumns(order, columns));\r\n                console.log(orderedColumns);\r\n            })()\r\n    },[])\r\n        \r\n    const sortColumns = (order:string[], columns:Column[]):Column[] => {\r\n        const result: Column[] = [];\r\n        \r\n        for( let o of order ){\r\n            for(let c of columns){\r\n                if(c.id === o){\r\n                    result.push(c);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    const injectHandleChange = (columns:Column[]):void => {\r\n        for(let c of columns){\r\n            if(c.id === 'date') c.handleChange = setDate;\r\n            if(c.id === 'place') c.handleChange = setPlace;\r\n            if(c.id === 'caughtFish') c.handleChange = setCaughtFish;\r\n            if(c.id === 'comment') c.handleChange = setComment;\r\n            if(c.id === 'rod') c.handleChange = setRod;\r\n            if(c.id === 'method') c.handleChange = setMethod;\r\n            if(c.id === 'lure') c.handleChange = setLure;\r\n            if(c.id === 'weather') c.handleChange = setWeather;\r\n            if(c.id === 'wind') c.handleChange = setWind;\r\n            if(c.id === 'tide') c.handleChange = setTide;\r\n        }\r\n    }\r\n    \r\n    const submit =async (e: SyntheticEvent)=> {\r\n        console.log('★submit★');\r\n        setIsLoad(true);\r\n        e.preventDefault();\r\n        const data: Diary = {\r\n            date: (isDateForInput(date)) ? date : undefined ,\r\n            place: place,\r\n            caughtFish: caughtFish,\r\n            comment: comment,\r\n            rod: rod,\r\n            method: method,\r\n            lure: lure,\r\n            weather: weather,\r\n            wind: wind,\r\n            tide: tide\r\n        }\r\n        console.log('data');\r\n        console.log(data);\r\n        navigate('/view', { state: { id:1 }});\r\n    }\r\n\r\n\r\n    return (\r\n        <StyledOuter>\r\n            {isLoad && <ModalSppiner height={100} width={100} />}\r\n            <StyledWrapper>\r\n                <form method=\"post\" onSubmit={ submit } >\r\n                    <StyledContainer>\r\n                            {orderedColumns?.map((oc)=>{\r\n                                if(isInput(oc)){\r\n                                    console.log(oc.value);\r\n                                    return <MFInput\r\n                                        label={oc.label}\r\n                                        id={oc.id}\r\n                                        input={oc.input}\r\n                                        key={oc.id}\r\n                                        value={oc.value}\r\n                                        handleChange={oc.handleChange}></MFInput>\r\n                                }else if(isPickList(oc)){\r\n                                    console.log(oc.value);\r\n                                    return <MFPicklist\r\n                                        label={oc.label}\r\n                                        id={oc.id}\r\n                                        select={oc.select}\r\n                                        options={oc.options}\r\n                                        key={oc.id}\r\n                                        value={oc.value}\r\n                                        handleChange={oc.handleChange}></MFPicklist>\r\n                                }else if(isMultiPickList(oc)){\r\n                                    console.log(oc.value);\r\n                                    return <MFMultiPicklist\r\n                                        label={oc.label}\r\n                                        id={oc.id}\r\n                                        select={oc.select}\r\n                                        options={oc.options}\r\n                                        key={oc.id}\r\n                                        value={oc.value}\r\n                                        handleChange={oc.handleChange}></MFMultiPicklist>\r\n                                }else if(isTextarea(oc)){\r\n                                    return <MFTextarea\r\n                                        label={oc.label}\r\n                                        id={oc.id}\r\n                                        textarea={oc.textarea}\r\n                                        key={oc.id}\r\n                                        value={oc.value}\r\n                                        handleChange={oc.handleChange}></MFTextarea>\r\n                                }\r\n                            })}\r\n                    </StyledContainer>\r\n                <StyledButtonWrapper>\r\n                    <StyledButtonContainer>\r\n                        <MFButton type={'submit'} disabled={false} mode={'positive'} hidden={false} >保存</MFButton>\r\n                    </StyledButtonContainer>\r\n                    <StyledButtonContainer>\r\n                        <MFButton type={'button'} disabled={false} mode={'negative'} hidden={false} >戻る</MFButton>\r\n                    </StyledButtonContainer>\r\n                </StyledButtonWrapper>\r\n                </form>\r\n            </StyledWrapper>\r\n        </StyledOuter>\r\n    )\r\n}\r\n\r\n\r\nconst isInput = (column: Column): column is (TextColumn | NumberColumn) => column.type === 'input';\r\nconst isPickList = (column: Column): column is PicklistColumn => column.type === 'picklist';\r\nconst isMultiPickList = (column: Column): column is MultiPicklistColumn => column.type === 'multipicklist';\r\nconst isTextarea = (column: Column): column is TextareaColumn => column.type === 'textarea';\r\n\r\nconst StyledContainer =styled.div`\r\ndisplay: grid;\r\npadding-top: 100px;\r\ngrid-auto-rows: 150px;\r\ngrid-template-columns: 50% 50%;\r\n`;\r\n\r\nconst StyledButtonWrapper =styled.div`\r\nwidth: 30%;\r\nmargin: 0 auto;\r\nheight: 150px;\r\nalign-items: center;\r\njustify-content: center;\r\ndisplay: flex;\r\nz-index: 0;\r\n`;\r\n\r\nconst StyledButtonContainer =styled.div`\r\nmargin: 0 10%;\r\n`;\r\n\r\nexport default DiaryEntry;"]},"metadata":{},"sourceType":"module"}